---
title: "Decision tree algorithm with CART algorithm"
output: html_notebook
---

1. Data collection

```{r}
loc <- "http://archive.ics.uci.edu/ml/machine-learning-databases/"
ds  <- "breast-cancer-wisconsin/breast-cancer-wisconsin.data"
url <- paste(loc, ds, sep="")

df <- read.table(url, sep=",", header=FALSE, na.strings="?")
names(df) <- c("ID", "clumpThickness", "sizeUniformity",
                   "shapeUniformity", "maginalAdhesion", 
                   "singleEpithelialCellSize", "bareNuclei", 
                   "blandChromatin", "normalNucleoli", "mitosis", "class")
```


```{r}
head(df)
```



```{r}
nrow(df)
```

```{r}
colnames(df)
```



```{r}
table(df$class)
```


```{r}
summary(df)
```



2. Data understanding

What are the fields with missing values ?

```{r}
str(df)
```

To convert the attribute class to catrgory attribute with factor 

```{r}
df$class <- factor(df$class, levels=c(2,4), 
                   labels=c("benign", "malignant"))
```


To plot the boxplot showing the distribution of clumpThickness for each of the class

```{r}
library(ggplot2)
ggplot(data=df,mapping=aes(x=class,y=clumpThickness))+geom_boxplot()
```


```{r}
ggplot(data=df,mapping=aes(x=clumpThickness))+geom_histogram(color="darkgreen",fill="white",bins=20)+facet_wrap(~class)

```
# Data cleaning

To impute the missing value of the attribute bareNuclei by the median value of that attribute when the class is benign or malignant respectively

```{r}
ggplot(data=df[! is.na(df$bareNuclei),],mapping=aes(x=class,y=bareNuclei))+geom_boxplot()
```


```{r}
median_vector<-tapply(df$bareNuclei, df$class, median,na.rm=T)
median_vector
```



```{r}
df$bareNuclei[is.na(df$bareNuclei)]<-ifelse(df$class[is.na(df$bareNuclei)]=="benign",median_vector["benign"],median_vector["malignant"])
```

```{r}
summary(df)
```




#Data splitting 

Exercise to split the data into two parts (training and testing data) by using sample() function.

Here we would like to split the data into two parts: 
training data: 70% of the data 
testing data: 30% of the data

Example of the use of sample function:
```{r}
sample(100,10)
```

```{r}
set.seed(1234)
train <- sample(nrow(df), 0.7*nrow(df))
df.train <- df[train,]
df.validate <- df[-train,]
prop.table(table(df.train$class))
prop.table(table(df.validate$class))
```

```{r}
library(rpart)

dtree <- rpart(class ~ ., data=df.train[,-c(1)], method="class",      
               parms=list(split="information"))
dtree$cptable
dtree.pruned <- prune(dtree, cp=.0125) 

```

```{r}
library(rpart.plot)
prp(dtree.pruned, type = 2, extra = 104,  
    fallen.leaves = TRUE, main="Decision Tree")
```

```{r}
#predict(dtree.pruned,df.validate,type="class")

table(predict(dtree.pruned,df.validate,type="class"),df.validate$class)
```



































